<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Save the date 08-01-2021</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta property="og:image" content="https://arisng.github.io/save-the-date-08-01-2021/images/couple-2.jpg" />
    <link rel="SHORTCUT ICON" href="./images/wedding-couple-32-182970.ico" />

    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" /> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-CuOF+2SnTUfTwSZjCXf01h7uYhfOBuxIhGKPbfEJ3+FqH/s6cIFN9bGr1HmAg4fQ" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/style.css" />
    <!-- <link rel="stylesheet" href="./css/style.min.css" /> -->
  </head>

  <body>
    <div class="content-container">
      <div class="card-container">
        <img class="card-background" src="./images/gold-wedding-card-bg.png">

        <div class="card-content">

          <div class="overlay title">We're getting married</div>
          <div class="overlay spouse1">Đ ình Tín</div>
          <div class="overlay vs">AND</div>
          <div class="overlay spouse2">Thu Linh</div>

          <div class="overlay venue">
            <div class="flex-fill overlay venue2">
              <div class="invitation">invite you</div>
              <div class="invitation">to celebrate our marriage</div>
              <!-- <p class="invitation">on friday</p> -->
              <div class="datetime">08 | 01 | 2021</div>
              <div class="time"><b>on friday, at 5:30 pm</b></div>
              <div class="place"><b>Quinter Center | sảnh Diamond</b> <i>86 Trần Phú - Nha Trang</i></div>
              <div class="">
                <a href="https://g.page/quinter-central-nha-trang?share" target="_blank">
                  <img src="./images/location-pin.svg" width="13px">map
                </a>
              </div>
            </div>
          </div>
          <div class="overlay countdownContainer">33 days, 22 hours, 05 min and 10 sec</div>
        </div>
      </div>

      <div class="form-container">
        <img class="form-background" src="./images/gold-border-frame-bg-3.png">

        <form id="form1" class="needs-validation" novalidate="">
          <div class="form-group mb-4">
            <label for="name" class="ml-4">✨ Tên của bạn 🎉</label>
            <input type="text" class="form-control" name="name" id="name" placeholder="nhớ điền tên nhé"
              autocomplete="off" required="">
            <div class="valid-feedback">✅</div>
            <div class="invalid-feedback">nhớ điền tên nè</div>
          </div>

          <div class="form-group mb-4">
            <label>📢 Để có một bữa tiệc được chu đáo nhất, xin bạn vui lòng
              xác nhận sự hiện diện của mình nhé</label>

            <div class="custom-control custom-radio mb-2">
              <input type="radio" class="custom-control-input" id="customRadio1" name="confirmation" value="yes"
                required="">
              <label class="custom-control-label" for="customRadio1">Tôi sẽ tham dự 😍🙌</label>
            </div>

            <div class="custom-control custom-radio">
              <input type="radio" class="custom-control-input" id="customRadio2" name="confirmation" value="no">
              <label class="custom-control-label" for="customRadio2">Rất tiếc, tôi không tham dự được 😒</label>
              <br>
              <small>nhớ đòi số tài khoản của chú rể nhé 😜</small>
              <div class="valid-feedback">✅</div>
              <div class="invalid-feedback">xác nhận giúp mình nhé</div>
            </div>
          </div>

          <div class="form-group mb-4">
            <label for="wishes">💌 Đôi lời tâm sự với Cô Dâu và Chú Rể 😊</label>
            <textarea class="form-control" id="wishes" rows="7" name="wishes" required=""></textarea>
            <div class="valid-feedback">✅</div>
            <div class="invalid-feedback">chúc gì đó đi 😘</div>
          </div>

          <div class="form-group form-actions d-flex form-group justify-content-center">
            <button id="submitBtn" class="btn" type="submit">
              <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true" style="display: none"></span>
              Xác Nhận
            </button>
          </div>

        </form>
      </div>
    </div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-popRpmFF9JQgExhfw5tZT4I9/CI5e2QcuUZPOVXb1m7qUmeR2b50u+YFEYe1wgzy"
      crossorigin="anonymous"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.5.0.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="./js/jquery.countdown.min.js"></script>
    <script type="text/javascript">
      //https://rendro.github.io/countdown/
      $(function () {
        $(".countdownContainer").countdown({
          date: "January 8, 2021 18:00:00",
          displayYear: false,
          //date: "February 16, 2020 23:15:00",
          render: function (date) {
            this.el.innerHTML =
              date.days +
              " days, " +
              this.leadingZeros(date.hours) +
              " hours, " +
              this.leadingZeros(date.min) +
              " min and " +
              this.leadingZeros(date.sec) +
              " sec";
          },
          onEnd: () => {
            alert("happy wedding!");
          }
        });
      });


      // Serialize form via jQuery
      (function ($) {
        $.fn.serializeFormJSON = function () {

          var o = {};
          var a = this.serializeArray();
          $.each(a, function () {
            if (o[this.name]) {
              if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
              }
              o[this.name].push(this.value || '');
            } else {
              o[this.name] = this.value || '';
            }
          });
          return o;
        };
      })(jQuery);

      let isFormValid = false;

      $(document).ready(function () {
        let windowHeight = $(window).innerHeight();
        let cardHeight = $(".card-container").outerHeight();

        let offset = windowHeight - cardHeight;

        if (offset > 0) {
          // $(".card-container").css("top", `${offset / 4}px`);
          $(".card-container").css("top", `2vh`);
        }

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.getElementsByClassName('needs-validation');
        // Loop over them and prevent submission
        var validation = Array.prototype.filter.call(forms, function (form) {
          form.addEventListener('submit', function (event) {
            event.preventDefault();
            event.stopPropagation();

            if (form.checkValidity() === false) {

            }
            else {
              isFormValid = true;

              let data = $(this).serializeFormJSON();
              // let data = JSON.parse(data);
              console.log(data)

              submitForm(data);
            }

            form.classList.add('was-validated');
          }, false);
        });
      });

      let submitBtnEl = document.getElementById('submitBtn');
      let spinnerEl = submitBtnEl.querySelector('.spinner-grow');

      function displaySpinner() {
        // re-enable submit button
        submitBtnEl.disabled = true;
        // hide spinner
        spinnerEl.style.display = '';
      }

      function hideSpinner() {
        // re-enable submit button
        submitBtnEl.disabled = true;
        // hide spinner
        spinnerEl.style.display = 'none';
      }

      function submitForm(data) {
        let url = 'https://script.google.com/macros/s/AKfycbwtFDR1OcQ66PskJoetEljs2unrTo14OKOIUYMcyj9lvfIYtuBi/exec';

        displaySpinner();

        var jqxhr = $.ajax({
          url: url,
          type: "GET",
          dataType: "json",
          data: data,
        }).success(function (result) {
          console.log("submit form - submitted successfully!")

          Swal.fire({
            title: 'Thank You!',
            text: "Love doesn't need to be Perfect. It just needs to be True",
            imageUrl: 'https://raw.githubusercontent.com/arisng/save-the-date-08-01-2021/tin-wedding/images/couple-2.jpg',
            imageWidth: 278,
            imageHeight: 389,
            imageAlt: 'couple'
          });

          hideSpinner();
        }).error(function (jqXHR, textStatus, errorThrown) {
          // console.log('textStatus = ' + textStatus);
          // console.log('errorThrown = ' + errorThrown);
          Swal.fire({
            title: 'Thank You',
            text: "Love doesn't need to be Perfect.It just needs to be True",
            imageUrl: 'https://raw.githubusercontent.com/arisng/save-the-date-08-01-2021/tin-wedding/images/couple-2.jpg',
            imageWidth: 278,
            imageHeight: 389,
            imageAlt: 'couple'
          });

          hideSpinner();
        });

        // var request = new XMLHttpRequest();
        // request.open('GET', url, true);
        // request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        // request.onprogress = function () {
        //   console.log('submit form - onprogress')
        // };

        // request.onload = function () {
        //   if (this.status >= 200 && this.status < 400) {
        //     // Success!
        //     var data = JSON.parse(this.response);
        //     console.log(data);
        //     console.log('submit form - submitted successfully!')

        //     Swal.fire({
        //       title: 'Sweet!',
        //       text: 'Thank You',
        //       imageUrl: 'https://raw.githubusercontent.com/arisng/save-the-date-08-01-2021/tin-wedding/images/couple-2.jpg',
        //       imageWidth: 278,
        //       imageHeight: 389,
        //       imageAlt: 'couple'
        //     });


        //   } else {
        //     // We reached our target server, but it returned an error
        //   }

        //   hideSpinner();
        // };

        // request.onerror = function () {
        //   // There was a connection error of some sort
        //   hideSpinner();
        // };

        // request.send(data);
      }
    </script>
    <!-- Code injected by live-server -->
    <script type="text/javascript">
      // <![CDATA[  <-- For SVG support
      if ('WebSocket' in window) {
        (function () {
          function refreshCSS() {
            var sheets = [].slice.call(document.getElementsByTagName("link"));
            var head = document.getElementsByTagName("head")[0];
            for (var i = 0; i < sheets.length; ++i) {
              var elem = sheets[i];
              var parent = elem.parentElement || head;
              parent.removeChild(elem);
              var rel = elem.rel;
              if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
                var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
                elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
              }
              parent.appendChild(elem);
            }
          }
          var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
          var address = protocol + window.location.host + window.location.pathname + '/ws';
          var socket = new WebSocket(address);
          socket.onmessage = function (msg) {
            if (msg.data == 'reload') window.location.reload();
            else if (msg.data == 'refreshcss') refreshCSS();
          };
          if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
            console.log('Live reload enabled.');
            sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
          }
        })();
      }
      else {
        console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
      }
  	// ]]>
    </script>

  </body>

</html>